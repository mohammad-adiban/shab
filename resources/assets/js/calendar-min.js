$(function(){function g(){var a=moment.utc();a=a.format("jYYYY-jMM-jDD");return a=moment.utc(a,"jYYYY-jMM-jDD")}function I(a){return a=a.startOf("jMonth")}function J(a){a=a.format("jYYYY-jMM-jDD");return a=moment(a,"jYYYY-jMM-jDD").format("YYYY-MM-DD")}function D(a,d){$(".monthName").html(M[a]+" "+digitsToHindi(d))}function N(a,d,c,e){return'<span class="calendar-day-item '+c+'" dayOfTheMonth="'+a+'" data="'+d+'"><div class="calendar-day-item-date" >'+digitsToHindi(a)+'</div><div class="calendar-day-item-price">'+
    digitsToHindi(e)+"</div></span>"}function K(a){return'<span class="calendar-day-noItem" data="'+a+'"></span>'}function A(){r();for(var a=1;a<l;a++){var d=parseInt(c)+864E5*a;$("."+d).addClass("calendar-day-minDisable")}}function r(){$(".calendar-day-minDisable").removeClass("calendar-day-minDisable")}function E(){m(".calendarLoading");var a=J(I(n));$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});a={house:$("#houseIdCalendar").val(),start:a};$.ajax({contentType:"application/x-www-form-urlencoded",
    type:"POST",url:"/calendars/show",data:a,success:function(a){for(var d=a.calendars,e=0;e<d.length;e++){var b=moment.utc(d[e].date,"YYYY-MM-DD").valueOf();1===d[e].disabled||1===d[e].unavailable?p.push(b):B.push(b+","+d[e].price)}a=a.peak_days;for(d=0;d<a.length;d++)e=moment.utc(a[d],"YYYY-MM-DD").valueOf(),F.push(e);a=n.jMonth();d=n.jYear();e=I(n);b=J(e);b=(parseInt(moment(b,"YYYY-MM-DD").format("d"))+1)%7;var g=0<=a&&5>=a?31:6<=a&&10>=a?30:11===a?moment.jDaysInMonth(d,11):void 0;var m=Math.ceil((g+
        b)/7);D(a,d);$(".calendar-body").append('<div class="calendar-month month-'+a+"-"+d+'"></div>');for(var t=0;t<m;t++){var l=Math.max(0,7*t-b),v=d,w=a,h=t,x=0===t?b:0,k=t===m-1?g-l:7,r=e;$(".month-"+w+"-"+v).append('<div class="calendar-day-row week-'+h+"-"+w+"-"+v+'"></div>');for(var y=0;y<x;y++)$(".week-"+h+"-"+w+"-"+v).append(K(y));for(;x<k;x++)l++,y=4>x?O:P,$(".week-"+h+"-"+w+"-"+v).append(N(l,x,moment.utc(r).valueOf(),y)),r.add(1,"day");for(;7>k;k++)$(".week-"+h+"-"+w+"-"+v).append(K(k))}$("."+
        L).addClass("calendar-day-today").prevAll().addClass("calendar-day-past");$("."+L).parent().prevAll().find(".calendar-day-item").addClass("calendar-day-past");e=$("."+c);b=$("."+f);0!==e.length&&c&&C(b);A();u();for(e=0;e<F.length;e++)$("."+F[e]).find(".calendar-day-item-price").html(digitsToHindi(Q));for(e=0;e<B.length;e++)$("."+B[e].split(",")[0]).find(".calendar-day-item-price").html(digitsToHindi(B[e].split(",")[1]));R(".month-"+a+"-"+d);q(".calendarLoading");z=!1},error:function(a){}})}function u(){$(".calendar-day-disable").removeClass("calendar-day-disable");
    for(var a=0;a<p.length;a++)$("."+p[a]).addClass("calendar-day-disable");if(!f&&c){a=!1;for(var d=0;d<p.length;d++)if(p[d]>parseInt(c)){a=p[d];break}if(a)for($("."+a).removeClass("calendar-day-disable"),a+=864E5;a<=$(".calendar-day-item").last().attr("class").split(/\s+/)[1];a+=864E5)$("."+a).addClass("calendar-day-disable")}}function R(a){$(a+" .calendar-day-item:not(.calendar-day-past)").click(function(){if(!$(this).hasClass("calendar-day-minDisable")&&!$(this).hasClass("calendar-day-disable"))if(!c)c=
    h($(this),"arrival"),$(".calendar-arrival-date").removeClass("active"),$(".calendar-departure-date").addClass("active"),A(),u();else if(c>$(this).attr("class").split(/\s+/)[1])G(),$(".calendar-arrival-date").removeClass("active"),$(".calendar-departure-date").addClass("active"),c=h($(this),"arrival"),A(),u();else if(c<$(this).attr("class").split(/\s+/)[1])if(f)G(),$(".calendar-arrival-date").removeClass("active"),$(".calendar-departure-date").addClass("active"),c=h($(this),"arrival"),A(),u();else{f=
    h($(this),"departure");$(".calendar-arrival-date").removeClass("active");$(".calendar-departure-date").removeClass("active");C($(this));r();var a=digitsToHindi((f-c)/864E5)+" \u0634\u0628 \u0627\u0646\u062a\u062e\u0627\u0628 \u0634\u062f\u0647";$(".calendar-bookedDays").html(a);u();H()}});$(a+" .calendar-day-item:not(.calendar-day-past)").hover(function(){$(this).hasClass("calendar-day-minDisable")||$(this).hasClass("calendar-day-disable")||c&&c<$(this).attr("class").split(/\s+/)[1]&&!f&&C($(this))});
    $(a+" .calendar-day-item:not(.calendar-day-past)").on("mouseleave",function(){f||$(".calendar-day-item").removeClass("calendar-day-item-hover")})}function h(a,d){var b=a.attr("class").split(/\s+/)[1];$("#"+d+"Calendar").val(b/1E3);var c=moment(parseInt(b)).utc().format("jYYYY/jMM/jDD");c=S[a.attr("data")]+"<br />"+c;a.addClass("calendar-day-item-active");$(".calendar-"+d+"-date").html(digitsToHindi(c));return b}function G(){q(".booking-totalPrice");q(".totalPrice-loading");$(".calendar-arrival-date").addClass("active");
    $(".calendar-departure-date").removeClass("active");$(".calendar-day-item").removeClass("calendar-day-item-active calendar-day-item-hover calendar-day-disable");r();$(".calendar-arrival-date").html("\u062a\u0627\u0631\u06cc\u062e \u0631\u0641\u062a");$(".calendar-departure-date").html("\u062a\u0627\u0631\u06cc\u062e \u0628\u0631\u06af\u0634\u062a");$(".calendar-bookedDays").html("\u062d\u062f\u0627\u0642\u0644 \u0645\u062f\u062a \u0631\u0632\u0631\u0648: "+digitsToHindi(l)+" \u0634\u0628");f=c=!1;
    u()}function C(a){a.addClass("calendar-day-item-hover");a.prevUntil(".calendar-day-item."+c,".calendar-day-item").addClass("calendar-day-item-hover");a.prevAll(".calendar-day-item."+c).length||(a.parent().prevUntil(".calendar-day-row:has(."+c+")").find(".calendar-day-item").addClass("calendar-day-item-hover"),6!=$("."+c).attr("data")&&a.parent().prevAll(".calendar-day-row:has(."+c+")").find(".calendar-day-item:last-child").addClass("calendar-day-item-hover").prevUntil(".calendar-day-item."+c).addClass("calendar-day-item-hover"))}
    function m(a){$(a).css("display","")}function q(a){$(a).css("display","none")}function H(){if(c&&f){q(".booking-totalPrice");m(".totalPrice-loading");$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});var a={checkin:c/1E3,checkout:f/1E3,guests:$(".guestsCount").val()};$.ajax({contentType:"application/x-www-form-urlencoded",type:"POST",url:"/houses/"+$("#houseIdCalendar").val()+"/price",data:a,success:function(a){a=digitsToHindi(1E3*a)+" \u062a\u0648\u0645\u0627\u0646";
        $(".booking-totalPrice span").html(a);q(".totalPrice-loading");m(".booking-totalPrice")},error:function(a){}})}}var M={0:"\u0641\u0631\u0648\u0631\u062f\u06cc\u0646",1:"\u0627\u0631\u062f\u06cc\u0628\u0647\u0634\u062a",2:"\u062e\u0631\u062f\u0627\u062f",3:"\u062a\u06cc\u0631",4:"\u0645\u0631\u062f\u0627\u062f",5:"\u0634\u0647\u0631\u06cc\u0648\u0631",6:"\u0645\u0647\u0631",7:"\u0622\u0628\u0627\u0646",8:"\u0622\u0630\u0631",9:"\u062f\u06cc",10:"\u0628\u0647\u0645\u0646",11:"\u0627\u0633\u0641\u0646\u062f"},
        S={0:"\u0634\u0646\u0628\u0647",1:"\u06cc\u06a9\u200c\u0634\u0646\u0628\u0647",2:"\u062f\u0648\u0634\u0646\u0628\u0647",3:"\u0633\u0647\u200c\u0634\u0646\u0628\u0647",4:"\u0686\u0647\u0627\u0631\u0634\u0646\u0628\u0647",5:"\u067e\u0646\u062c\u200c\u0634\u0646\u0628\u0647",6:"\u062c\u0645\u0639\u0647"},n=g(),b=n,L=n.valueOf(),c=!1,f=!1,l=$("#ruleMinimumDays").val(),p=[],B=[],F=[],O=$("#minPrice").val(),P=$("#medianPrice").val(),Q=$("#maxPrice").val(),z=!0;$(document).ready(function(){$(".calendar-arrival-date").addClass("active");
        993<$(window).width()&&(n=g(),b=g(),$(".previousMonth").css("visibility","hidden"),$(".calendar-month").remove(),p=[],$(".calendar-container").css("visibility","visible"),E(),$(".calendar-bookedDays").html("\u062d\u062f\u0627\u0642\u0644 \u0645\u062f\u062a \u0631\u0632\u0631\u0648: "+digitsToHindi(l)+" \u0634\u0628"));$("#bookingBtn").click(function(a){a.target===this&&(z=!0,n=g(),b=g(),$(".previousMonth").css("visibility","hidden"),$(".calendar-month").remove(),p=[],$(".calendar-container").css("visibility",
            "visible"),E(),$(".calendar-bookedDays").html("\u062d\u062f\u0627\u0642\u0644 \u0645\u062f\u062a \u0631\u0632\u0631\u0648: "+digitsToHindi(l)+" \u0634\u0628"))});$(".nextMonth").click(function(a){z||(z=!0,$(".month-"+b.jMonth()+"-"+b.jYear()).css("display","none"),b.add(1,"jMonth"),$(".previousMonth").css("visibility","visible"),0!==$(".month-"+b.jMonth()+"-"+b.jYear()).length?($(".month-"+b.jMonth()+"-"+b.jYear()).css("display",""),z=!1):E(),D(b.jMonth(),b.jYear()))});$(".previousMonth").click(function(){$(".month-"+
            b.jMonth()+"-"+b.jYear()).css("display","none");b.subtract(1,"jMonth");if(0!==$(".month-"+b.jMonth()+"-"+b.jYear()).length&&($(".month-"+b.jMonth()+"-"+b.jYear()).css("display",""),c)){var a=b;a.endOf("jMonth");a.startOf("day");a=moment.utc(a).valueOf();c<=a&&C($("."+a))}b.jMonth()===g().jMonth()&&$(".previousMonth").css("visibility","hidden");D(b.jMonth(),b.jYear())});$(".calendar-reset-btn").click(function(){G()});$(".submitBtn, .submitBtn-noLogin").click(function(a){if("\u062a\u0627\u0631\u06cc\u062e \u0631\u0641\u062a"===
            $(".calendar-arrival-date").html()||"\u062a\u0627\u0631\u06cc\u062e \u0628\u0631\u06af\u0634\u062a"===$(".calendar-departure-date").html())return setTimeout(function(){alert("\u0627\u0628\u062a\u062f\u0627 \u062a\u0627\u0631\u06cc\u062e \u0631\u0641\u062a \u0648 \u0628\u0631\u06af\u0634\u062a \u0631\u0627 \u0645\u0634\u062e\u0635 \u06a9\u0646\u06cc\u062f")},270),!1;if("0"===$(".guestsCount").val())return setTimeout(function(){alert("\u062a\u0639\u062f\u0627\u062f \u0645\u0647\u0645\u0627\u0646 \u0631\u0627 \u0645\u0634\u062e\u0635 \u0646\u0645\u0627\u06cc\u06cc\u062f")},
            270),!1;$(this).hasClass("submitBtn")&&$("#payform").submit()})});var k;$(".guestUp").click(function(){if(!$(this).hasClass("guest-btn-disable")){var a=parseInt(guestCount.val())+1;clearTimeout(k);c&&f&&(q(".booking-totalPrice"),m(".totalPrice-loading"));k=setTimeout(function(){H()},1500);if(a<=maxAccommodates){1!==a&&$(".guestDown").removeClass("guest-btn-disable");$(".guestCountDisplay").html(digitsToHindi(a));guestCount.val(a);if(a>accommodates){var b="\u0646\u0641\u0631\u0627\u062a \u0627\u0636\u0627\u0641\u0647: "+
        digitsToHindi(a-accommodates);$(".okAccommodates").html(b)}a===maxAccommodates&&$(".guestUp").addClass("guest-btn-disable");$("#accomodatesCalendar").val(a)}}});$(".guestDown").click(function(){if(!$(this).hasClass("guest-btn-disable")){var a=parseInt(guestCount.val())-1;clearTimeout(k);c&&f&&(q(".booking-totalPrice"),m(".totalPrice-loading"));k=setTimeout(function(){H()},1500);if(1<=a){$(".guestUp").removeClass("guest-btn-disable");$(".guestCountDisplay").html(digitsToHindi(a));guestCount.val(a);
        if(a>=accommodates){var b=a-accommodates?"\u0646\u0641\u0631\u0627\u062a \u0627\u0636\u0627\u0641\u0647: "+digitsToHindi(a-accommodates):"";$(".okAccommodates").html(b)}1===a&&$(".guestDown").addClass("guest-btn-disable");$("#accomodatesCalendar").val(a)}}})});